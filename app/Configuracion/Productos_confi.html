<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos</title>
</head>
<body>
    <datalist id="categorias">
        <option value="Bebidas"></option>
        <option value="Platillos"></option>
        <option value="Postres"></option>
        <option value="Entradas"></option>
    </datalist> 

    <header>
        <div id="navbar-configuracion" class="navbar-configuracion"></div>
    </header>

    <div class="Datos">
        <h1> Nombre del producto: </h1>
        <input id="nombre-producto" type="text" placeholder="Agregue un nombre a su producto">
        <h1> Categoria del producto: </h1>
        <input id="categoria_producto" type="text" list="categorias" placeholder="Seleccione una categoria para su producto">
        <h1> Imagen del producto: </h1>
        <input type="text" id="img-agreg">
        <h1> Descripcion del producto: </h1>
        <textarea id="descripcion_producto" name="textos"  placeholder="Escribe el texto del producto" required></textarea>
        <h1> Precio del producto: </h1>
        <input id="precio_producto" type="number" placeholder="Coloque el precio de su producto">
        <h1> Cantidad del producto: </h1>
        <input id="cantidad_producto" type="number" placeholder="Coloque el stock de su producto">
        <button id="agreg_pro" class="Boton_submit">Agregar Producto</button>
    </div>

    <div class="productos-ya-creados" id="productos-ya-creados">
    <div id="Drinks" class="Drinks"></div>

    <div id="Food" class="Food"></div>

    <div id="Desserts" class="Desserts"></div>

    <div id="Tickets" class="Tickets"></div>
    </div>
    
</body>

<script src="/Producto.js"></script>


<script>

document.getElementById("agreg_pro").addEventListener('click', async () => {
    const nombre = document.getElementById("nombre-producto").value;
    const categoria = document.getElementById("categoria_producto").value;
    const descripcion = document.getElementById("descripcion_producto").value;
    const precio = parseFloat(document.getElementById("precio_producto").value);
    const stock = parseInt(document.getElementById("cantidad_producto").value);
    const imgFile = document.getElementById("img-agreg").value;

    try {
        const response = await fetch('http://localhost:3500/AgregarProductos', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ nombre, categoria, precio, stock, descripcion, imgFile })
        });

        const responseData = await response.json();
        console.log('Mensaje del servidor:', responseData.message || 'Sin mensaje de error');

        console.log('Estado de respuesta:', response.status);
        console.log('Respuesta completa:', response);

        if (response.ok) {
            alert('Producto agregado exitosamente');
        } else {
            alert('Problemas al agregar el producto');
        }
    } catch (e) {
        alert('Se agrego el producto correctamente');
    }
});

    fetch('/NavbarConfiguracion')
           .then(response => response.text())
           .then(data => {
               // Insertar el HTML en el contenedor
               document.getElementById('navbar-configuracion').innerHTML = data;

               // Crear un script para ejecutar el contenido JS de Producto.js
               const script = document.createElement('script');
               script.src = '/Producto.js';  // Ruta del script
               script.onload = () => {
                   console.log('El script se cargó y ejecutó correctamente');
               };
               document.body.appendChild(script);
           })
           .catch(error => console.error('Error al cargar el navbar:', error));

</script>
<footer>
    ©Todos los derechos reservados
</footer>
</html>